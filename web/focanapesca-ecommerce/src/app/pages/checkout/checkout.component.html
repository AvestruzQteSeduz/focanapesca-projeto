<div class="checkout-container">

  <div class="checkout-form-section">
    <form [formGroup]="checkoutForm" (ngSubmit)="finalizarPedido()">

      <div class="card">
        <h3>游늸 Endere칞o de Entrega</h3>

        <div class="form-row">
          <div class="form-group col-cep">
            <label>CEP</label>
            <input type="text" formControlName="cep" mask="00000-000" (blur)="buscarCep()" placeholder="00000-000">
            <small *ngIf="checkoutForm.get('cep')?.invalid && checkoutForm.get('cep')?.touched" class="error">CEP obrigat칩rio</small>
          </div>
          <div class="form-group col-rua">
            <label>Rua</label>
            <input type="text" formControlName="rua" readonly> </div>
        </div>

        <div class="form-row">
          <div class="form-group col-num">
            <label>N칰mero</label>
            <input type="text" formControlName="numero">
          </div>
          <div class="form-group col-bairro">
            <label>Bairro</label>
            <input type="text" formControlName="bairro" readonly>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group col-cidade">
            <label>Cidade</label>
            <input type="text" formControlName="cidade" readonly>
          </div>
          <div class="form-group col-uf">
            <label>UF</label>
            <input type="text" formControlName="estado" readonly>
          </div>
        </div>
      </div>

      <div class="card payment-card">
        <h3>游눱 Pagamento</h3>

        <div class="form-group">
          <label>Forma de Pagamento</label>
          <select formControlName="metodoPagamento">
            <option value="CARTAO">Cart칚o de Cr칠dito</option>
            <option value="PIX">PIX</option>
            <option value="BOLETO">Boleto Banc치rio</option>
          </select>
        </div>

        <div *ngIf="checkoutForm.get('metodoPagamento')?.value === 'CARTAO'" class="credit-card-fields">
          <div class="form-group">
            <label>Nome no Cart칚o</label>
            <input type="text" formControlName="titularCartao" placeholder="Como impresso no cart칚o">
          </div>

          <div class="form-group">
            <label>N칰mero do Cart칚o</label>
            <input type="text" formControlName="numeroCartao" mask="0000 0000 0000 0000" placeholder="0000 0000 0000 0000">
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Validade</label>
              <input type="text" formControlName="validadeCartao" mask="00/00" placeholder="MM/AA">
            </div>
            <div class="form-group">
              <label>CVV</label>
              <input type="text" formControlName="cvvCartao" mask="000" placeholder="123">
            </div>
          </div>
        </div>

        <div *ngIf="checkoutForm.get('metodoPagamento')?.value === 'PIX'" class="pix-info">
          <p>O c칩digo PIX ser치 gerado na pr칩xima tela.</p>
        </div>
      </div>

      <button type="submit" class="btn-submit mobile-only" [disabled]="checkoutForm.invalid">Finalizar Compra</button>

    </form>
  </div>

  <div class="checkout-summary-section">
    <div class="card summary-card">
      <h3>Resumo do Pedido</h3>

      <div class="summary-items">
        <div *ngFor="let item of itens" class="summary-item">
          <span>{{ item.quantidadePedido }}x {{ item.nome }}</span>
          <span>R$ {{ (item.preco * item.quantidadePedido).toFixed(2) }}</span>
        </div>
      </div>

      <div class="summary-totals">
        <div class="row">
          <span>Subtotal</span>
          <span>R$ {{ total.toFixed(2) }}</span>
        </div>
        <div class="row freight">
          <span>Frete</span>
          <span *ngIf="frete > 0">R$ {{ frete.toFixed(2) }}</span>
          <span *ngIf="frete === 0" class="calculating">Digite o CEP...</span>
        </div>
        <div class="row total">
          <span>Total</span>
          <span>R$ {{ (total + frete).toFixed(2) }}</span>
        </div>
      </div>

      <button (click)="finalizarPedido()" class="btn-submit desktop-only" [disabled]="checkoutForm.invalid">
        FINALIZAR COMPRA
      </button>
    </div>
  </div>

</div>
